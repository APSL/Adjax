jQuery.adjax_callbacks={show_message:function(message){var msg_html=jQuery('<p class="message '+message.tags+'">'+message.content+'</p>');msg_html.hide();jQuery('#messages').prepend(msg_html);msg_html.slideDown('slow');if(message.level<40){msg_html.wait(2000).slideUp('slow');}}};var process_json_response=function(json){if(json.redirect){window;window.location.href=json.redirect;}
if(json.messages){for(var msg in json.messages){jQuery.adjax_callbacks.show_message(json.messages[msg]);}}
if(json.replace){for(var replace_idx in json.replace){jQuery(replace_idx).html(json.replace[replace_idx]).show();}
if(json.document_ready){document_ready();}}
if(json.hide){for(var element in json.hide){jQuery(json.hide[element]).hide();}}
if(json.update){for(var update_idx in json.update){jQuery("."+update_idx).html(json.update[update_idx]);}}};var form_processor_factory=function(form_obj,callback){if(!form_obj){form_obj=jQuery;}
return function(json){process_json_response(json);var errors=json.forms;form_obj.find('.errorlist').remove();form_obj.find('.error').removeClass('error');var display_form_error=function(){jQuery(this).addClass('error');jQuery(this).after(html);};for(var error in errors){var html='<ul class="errorlist">';for(var msg in errors[error]){html+='<li>'+errors[error][msg]+'</li>';}
html+='</ul>';if(error=='__all__'){form_obj.prepend(html);}
else{form_obj.find('#form-error-'+error).each(display_form_error);form_obj.find('#'+error).each(display_form_error);}}
if(callback){callback(json);}};};jQuery.adjax=function(url,data,callback){jQuery.ajax({url:url,dataType:'json',data:data,cache:false,success:function(json){process_json_response(json);if(callback){callback(json);}}});return false;};jQuery.fn.adjax=function(data,callback){this.each(function(){var obj=jQuery(this);if(obj.attr('href')){var url=obj.attr('href').split("?")[0];jQuery.adjax(url,data,callback);return false;}else if(obj.attr('action')){var form_processor=form_processor_factory(obj,callback);obj.ajaxSubmit({success:form_processor,dataType:'json'});return false;}});return false;};jQuery.fn.adjaxify=function(callback){this.each(function(){var obj=jQuery(this);if(obj.attr('href')){obj.click(function(){return obj.adjax(null,callback);});}
else if(obj.is('form')){var submit_form=function(){obj.ajaxSubmit({success:form_processor_factory(obj,callback),dataType:'json'});return false;};obj.submit(submit_form);}});};jQuery.fn.wait=function(time){var obj=jQuery(this);obj.queue(function(){setTimeout(function(){obj.dequeue();},time);});return obj;};